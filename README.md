# telekom-test-task
python3.9.5, asyncio, pytest
# Условия задачи
```
Необходимо сделать tcp сервер, который распознаёт заданный формат данных и отображает его в требуемом формате. Обязательна запись данных во внешний файл. 
Интерфейс и способ отображения на выбор разработчика. 
Формат данных BBBBxNNxHH:MM:SS.zhqxGGCR Где BBBB - номер участника x - пробельный символ NN - id канала HH - Часы MM - минуты SS - секунды zhq - десятые сотые тысячные GG - номер группы CR - «возврат каретки» (закрывающий символ)
Пример данных: 0002 C1 01:13:02.877 00[CR] Выводим «спортсмен, нагрудный номер BBBB прошёл отсечку NN в «время»" до десятых, сотые и тысячные отсекаются. 
Только для группы 00. Для остальных групп данные не отображаются, но пишутся в лог полностью.
Язык Python, версия не ниже 3.2
Передача данных должна поддерживаться с помощью telnet клиента.
```
# Описание разработанного решения

Для поиска последовательности, определенного форматом данных, были использованы регулярные выражения на основе ```re```. Было использовано следующее регулярное выражение:
```
rb'\r(\d{4}) (\w{2}) (\d{2}):(\d{2}):(\d{2})[.](\d{3}) (\d{2})\r'
``` 
Отсутствие проверки правильности полученной последовательности цифр (например, на корректную дату) было сделано специально, чтобы можно было выделить такие записи из общего числа.

Обработка пришедших данных происходит в потоковом режиме. Корректный поток характеризуется следующей последовательностью:
```
[CR]<packet>[CR]<packet>[CR]<packet>[CR]<packet> ...
```
Запись считается корректной в том случае, когда с обеих сторон обрамлена символом [CR]. В противном случае, считается, что имело место нарушение потока данных. Максимальная длина пакета -- 64 байта. Максимальный размер данных TCP-пакета -- 128 байт.



Для реализации TCP-сервера была выбрана библиотека ```asyncio```. Для обработки входящих запросов была реализован класс ```RequestHandler```, который в конструкторе принимает объект класса ```StreamWriter``` (для обработки входящего потока), и два объекта класса ```MessageHandler``` (для обработки "хороших" и "плохих" записей). Объекты ```MessageHandler``` нужны для инициализации объекта ```StreamWriter```. 
Для каждого TCP-соединения создается отдельный обработчик ```StreamWriter```.
Считывание потока реализовано в асинх. функции ```handle_loop``` с помощью механизма задач ```Task```. 

Передача при помощи Telnet-клиента возможно только в пассивном режиме, без обработки команд протокола.

# Запуск решения

```
python app.py
```